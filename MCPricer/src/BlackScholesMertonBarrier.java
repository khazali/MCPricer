public class BlackScholesMertonBarrier {
    private double optionPrice;
    private double delta;
    private double gamma;
    private double vega;

    public BlackScholesMertonBarrier(double price, double strike, double barrier, double riskFreeRate, double volatility, double duration, String type) {        
        double d1, d2;

        d1=(Math.log(price/strike)+(riskFreeRate+volatility*volatility/2)*duration)/(volatility*Math.sqrt(duration));
        d2=d1-volatility*Math.sqrt(duration);
                
        if (type.equals("CallDownIn")) {
            double H = barrier*Math.exp(-0.5826*volatility*Math.sqrt(1.0/365.0));
            if (H < strike) {
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double y = Math.log(H*H/(price*strike))/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = price*Math.pow(H/price, 2*g)*cdf(y) - strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*cdf(y - volatility*Math.sqrt(duration));

                this.delta = -(Math.exp(- (2913*Math.sqrt(365)*volatility)/912500 - 2*duration*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility)))*((barrier*barrier)*volatility*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 + 2*duration*riskFreeRate)*pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + 2*(barrier*barrier)*Math.sqrt(duration)*riskFreeRate*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 + 2*duration*riskFreeRate)*cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - price*strike*volatility*Math.exp((8739*Math.sqrt(365)*volatility)/1825000 + duration*riskFreeRate)*pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - 2*Math.sqrt(duration)*price*riskFreeRate*strike*Math.exp((8739*Math.sqrt(365)*volatility)/1825000 + duration*riskFreeRate)*cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + Math.sqrt(duration)*price*strike*(volatility*volatility)*Math.exp((8739*Math.sqrt(365)*volatility)/1825000 + duration*riskFreeRate)*cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))))/(barrier*Math.sqrt(duration)*price*(volatility*volatility));
                this.gamma = (Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility)))*((barrier*barrier)*(volatility*volatility)*xpdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + 4*(barrier*barrier)*duration*(riskFreeRate*riskFreeRate)*cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + (barrier*barrier)*Math.sqrt(duration)*(volatility*volatility*volatility)*pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + 2*(barrier*barrier)*duration*riskFreeRate*(volatility*volatility)*cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - price*strike*(volatility*volatility)*xpdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp((2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate) + 4*(barrier*barrier)*Math.sqrt(duration)*riskFreeRate*volatility*pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + Math.sqrt(duration)*price*strike*(volatility*volatility*volatility)*Math.exp((2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - 4*duration*price*(riskFreeRate*riskFreeRate)*strike*Math.exp((2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - 4*Math.sqrt(duration)*price*riskFreeRate*strike*volatility*Math.exp((2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + 2*duration*price*riskFreeRate*strike*(volatility*volatility)*Math.exp((2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))))/(barrier*duration*(price*price)*(volatility*volatility*volatility*volatility));
                this.vega = (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(912500*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate + 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)) - (price*pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(912500*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate - 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)) - (barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) + (price*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
            }
            else {
                double c = price*cdf(d1)-strike*Math.exp(-riskFreeRate*duration)*cdf(d2);
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double x1 = Math.log(price/H)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double y1 = Math.log(H/price)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = c - (price*cdf(x1) - strike*Math.exp(-riskFreeRate*duration)*cdf(x1 - volatility*Math.sqrt(duration)) - price*Math.pow(H/price, 2*g)*cdf(y1) + strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*cdf(y1 - volatility*Math.sqrt(duration)));
                this.delta = cdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility)) - cdf(Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5)) + cdf(Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)) - pdf(Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))/(Math.sqrt(duration)*volatility) + pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) - (pdf(Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)))/(Math.sqrt(duration)*volatility) - (barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*cdf(Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*((2*riskFreeRate)/(volatility*volatility) + 1)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/price - (strike*Math.exp(-duration*riskFreeRate)*pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) + (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5)))/(Math.sqrt(duration)*price*volatility) + (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/(Math.sqrt(duration)*price*volatility) + (barrier*strike*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*Math.exp(-duration*riskFreeRate)*cdf(Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*((2*riskFreeRate)/(volatility*volatility) - 1)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 2)))/(price*price);
                this.gamma = pdf(((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) - pdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) - xpdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) + xpdf(((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) - (pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) + (xpdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*price*(volatility*volatility)) + (strike*pdf((- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(Math.sqrt(duration)*(price*price)*volatility) - (strike*Math.exp(-duration*riskFreeRate)*xpdf((- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility)))/(duration*(price*price)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*(price*price)*volatility) + (strike*xpdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility)) - (strike*xpdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*(price*price)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*volatility) + (2*(barrier*barrier)*riskFreeRate*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500)*cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*((volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price)*(volatility*volatility*volatility*volatility)) - (2*barrier*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price*price)*(volatility*volatility)) + (2*barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*((volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*(volatility*volatility*volatility)) - (2*(barrier*barrier)*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- 3*(volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price*price)*(volatility*volatility*volatility*volatility)) - (2*barrier*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/(Math.sqrt(duration)*(price*price*price)*(volatility*volatility*volatility));
                this.vega = (price*pdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (price*pdf(((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))*(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate))/(2*Math.sqrt(duration)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (price*pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(1825000*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (strike*pdf((- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate))/(Math.sqrt(duration)*(volatility*volatility)) - (barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(1825000*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (price*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
            }
        }        
        else if (type.equals("CallDownOut")) {
            double H = barrier*Math.exp(-0.5826*volatility*Math.sqrt(1.0/365.0));
            if (H < strike) {
                double c = price*cdf(d1)-strike*Math.exp(-riskFreeRate*duration)*cdf(d2);
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double y = Math.log(H*H/(price*strike))/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = c - (price*Math.pow(H/price, 2*g)*cdf(y) - strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*cdf(y - volatility*Math.sqrt(duration)));
                this.delta = cdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility)) - cdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)) + pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) + (pdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)))/(Math.sqrt(duration)*volatility) + (barrier*cdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*((2*riskFreeRate)/(volatility*volatility) + 1)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/price - (strike*Math.exp(-duration*riskFreeRate)*pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) - (strike*pdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.sqrt(duration)*volatility + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/(Math.sqrt(duration)*price*volatility) - (barrier*strike*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*Math.exp(-duration*riskFreeRate)*cdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.sqrt(duration)*volatility + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*((2*riskFreeRate)/(volatility*volatility) - 1)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 2)))/(price*price);
                this.gamma = pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) + xpdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) - (xpdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)))/(duration*price*(volatility*volatility)) + (pdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)))/(Math.sqrt(duration)*price*volatility) + (strike*Math.exp(-duration*riskFreeRate)*pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*(price*price)*volatility) - (strike*xpdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility)*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility)) + (strike*pdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.sqrt(duration)*volatility + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/(Math.sqrt(duration)*(price*price)*volatility) + (strike*xpdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.sqrt(duration)*volatility + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/(duration*(price*price)*(volatility*volatility)) - (2*barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*pdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*((2*riskFreeRate)/(volatility*volatility) + 1)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*volatility) - (2*(barrier*barrier)*riskFreeRate*cdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500)*((2*riskFreeRate)/(volatility*volatility) + 1)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/((price*price*price)*(volatility*volatility)) + (2*barrier*strike*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*Math.exp(-duration*riskFreeRate)*cdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.sqrt(duration)*volatility + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*((2*riskFreeRate)/(volatility*volatility) - 1)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 2)))/(price*price*price) + ((barrier*barrier)*strike*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500)*Math.exp(-duration*riskFreeRate)*cdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.sqrt(duration)*volatility + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*((2*riskFreeRate)/(volatility*volatility) - 1)*((2*riskFreeRate)/(volatility*volatility) - 2)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 3)))/(price*price*price*price) + (2*barrier*strike*pdf(Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.sqrt(duration)*volatility + Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*Math.exp(-duration*riskFreeRate)*((2*riskFreeRate)/(volatility*volatility) - 1)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 2)))/(Math.sqrt(duration)*(price*price*price)*volatility);
                this.vega = (barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) - (price*pdf(((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))*(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate))/(2*Math.sqrt(duration)*(volatility*volatility)) + (strike*pdf((- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate))/(Math.sqrt(duration)*(volatility*volatility)) + (price*pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(912500*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate - 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(912500*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate + 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)) - (price*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
            }
            else {                
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double x1 = Math.log(price/H)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double y1 = Math.log(H/price)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = price*cdf(x1) - strike*Math.exp(-riskFreeRate*duration)*cdf(x1 - volatility*Math.sqrt(duration)) - price*Math.pow(H/price, 2*g)*cdf(y1) + strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*cdf(y1 - volatility*Math.sqrt(duration));
                this.delta = cdf(Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5)) - cdf(Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)) + pdf(Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))/(Math.sqrt(duration)*volatility) + (pdf(Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)))/(Math.sqrt(duration)*volatility) + (barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*cdf(Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*((2*riskFreeRate)/(volatility*volatility) + 1)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/price - (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5)))/(Math.sqrt(duration)*price*volatility) - (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/(Math.sqrt(duration)*price*volatility) - (barrier*strike*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*Math.exp(-duration*riskFreeRate)*cdf(Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility + Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*((2*riskFreeRate)/(volatility*volatility) - 1)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 2)))/(price*price);
                this.gamma = pdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) + xpdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) + (pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) - (xpdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*price*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*(price*price)*volatility) - (strike*xpdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility)) + (strike*xpdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*(price*price)*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*volatility) - (2*(barrier*barrier)*riskFreeRate*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500)*cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*((volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price)*(volatility*volatility*volatility*volatility)) + (2*barrier*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price*price)*(volatility*volatility)) - (2*barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*((volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*(volatility*volatility*volatility)) + (2*(barrier*barrier)*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- 3*(volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price*price)*(volatility*volatility*volatility*volatility)) + (2*barrier*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/(Math.sqrt(duration)*(price*price*price)*(volatility*volatility*volatility));
                this.vega = (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (price*pdf((2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (price*pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(1825000*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(1825000*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (price*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
            }
        }
        else if (type.equals("CallUpIn")) {
            double H = barrier*Math.exp(0.5826*volatility*Math.sqrt(1.0/365.0));
            if (H > strike) {
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double y = Math.log(H*H/(price*strike))/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double x1 = Math.log(price/H)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double y1 = Math.log(H/price)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = price*cdf(x1) - strike*Math.exp(-riskFreeRate*duration)*cdf(x1 - volatility*Math.sqrt(duration)) - price*Math.pow(H/price, 2*g)*(cdf(-y) - cdf(-y1)) + strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*(cdf(-y + volatility*Math.sqrt(duration)) - cdf(-y1 + volatility*Math.sqrt(duration)));
                this.delta = cdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + (cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) + pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) + ((pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*volatility) - (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*price*volatility) - (barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*((volatility*volatility) + 2*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(price*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*(pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) + (barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price)*(volatility*volatility));
                this.gamma = pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) + xpdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) + ((pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) + ((xpdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - xpdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*price*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*(price*price)*volatility) - (strike*xpdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*(xpdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - xpdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*(price*price)*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*(pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*volatility) - (2*barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price*price)*(volatility*volatility)) - (2*barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*((volatility*volatility) + 2*riskFreeRate)*(pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*(volatility*volatility*volatility)) + (2*(barrier*barrier)*riskFreeRate*Math.exp((2913*Math.sqrt(365)*volatility)/912500)*((volatility*volatility) + 2*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price)*(volatility*volatility*volatility*volatility)) + (2*barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/(Math.sqrt(duration)*(price*price*price)*(volatility*volatility*volatility)) - (2*(barrier*barrier)*strike*Math.exp((2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*(- (volatility*volatility) + riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- 3*(volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price*price)*(volatility*volatility*volatility*volatility));
                this.vega = price*((pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(912500*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) - 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate - 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) - strike*Math.exp(-duration*riskFreeRate)*((pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(912500*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) - 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate + 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) - (price*pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*(2913*Math.sqrt(365)*(volatility*volatility*volatility) - 7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) + (price*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*(7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) - 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
            }
            else {                
                this.optionPrice = price*cdf(d1)-strike*Math.exp(-riskFreeRate*duration)*cdf(d2);
                this.delta = cdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility)) + pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) - (strike*Math.exp(-duration*riskFreeRate)*pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility);
                this.gamma = pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) + xpdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*(price*price)*volatility) - (strike*xpdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility)*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility));
                this.vega = price*pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))*(Math.sqrt(duration) - (Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*(volatility*volatility))) + (strike*Math.exp(-duration*riskFreeRate)*pdf((Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility)*(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate)))/(Math.sqrt(duration)*(volatility*volatility));
            }
        }
        else if (type.equals("CallUpOut")) {
            double H = barrier*Math.exp(0.5826*volatility*Math.sqrt(1.0/365.0));
            if (H > strike) {
                double c = price*cdf(d1)-strike*Math.exp(-riskFreeRate*duration)*cdf(d2);
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double y = Math.log(H*H/(price*strike))/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double x1 = Math.log(price/H)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double y1 = Math.log(H/price)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = c - (price*cdf(x1) - strike*Math.exp(-riskFreeRate*duration)*cdf(x1 - volatility*Math.sqrt(duration)) - price*Math.pow(H/price, 2*g)*(cdf(-y) - cdf(-y1)) + strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*(cdf(-y + volatility*Math.sqrt(duration)) - cdf(-y1 + volatility*Math.sqrt(duration))));
                this.delta = cdf(((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility)) - cdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - (cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) - pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) + pdf(((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) - ((pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*volatility) - (strike*pdf((- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(Math.sqrt(duration)*price*volatility) + (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*price*volatility) + (barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*((volatility*volatility) + 2*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(price*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*(pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) - (barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price)*(volatility*volatility));
                this.gamma = pdf(((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) - pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) - xpdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) + xpdf(((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) - ((pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) - ((xpdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - xpdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*price*(volatility*volatility)) + (strike*pdf((- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(Math.sqrt(duration)*(price*price)*volatility) - (strike*Math.exp(-duration*riskFreeRate)*xpdf((- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility)))/(duration*(price*price)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*(price*price)*volatility) + (strike*xpdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*(xpdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - xpdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*(price*price)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*(pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*volatility) + (2*barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price*price)*(volatility*volatility)) + (2*barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*((volatility*volatility) + 2*riskFreeRate)*(pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*(volatility*volatility*volatility)) - (2*(barrier*barrier)*riskFreeRate*Math.exp((2913*Math.sqrt(365)*volatility)/912500)*((volatility*volatility) + 2*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price)*(volatility*volatility*volatility*volatility)) - (2*barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/(Math.sqrt(duration)*(price*price*price)*(volatility*volatility*volatility)) + (2*(barrier*barrier)*strike*Math.exp((2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*(- (volatility*volatility) + riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- 3*(volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price*price)*(volatility*volatility*volatility*volatility));
                this.vega = strike*Math.exp(-duration*riskFreeRate)*((pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(912500*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) - 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate + 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) - price*((pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(912500*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) - 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate - 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) + (price*pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (price*pdf(((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))*(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate))/(2*Math.sqrt(duration)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf((2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*(2913*Math.sqrt(365)*(volatility*volatility*volatility) - 7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) + (strike*pdf((- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate))/(Math.sqrt(duration)*(volatility*volatility)) - (price*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*(7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) - 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
            }
            else {                
                this.optionPrice = 0;
                this.delta = 0;
                this.gamma = 0;
                this.vega = 0;                
            }            
        }

        else if (type.equals("PutDownIn")) {
            double H = barrier*Math.exp(-0.5826*volatility*Math.sqrt(1.0/365.0));
            if (H > strike) {
                this.optionPrice = strike*Math.exp(-riskFreeRate*duration)*cdf(-d2)-price*cdf(-d1);
                this.delta = pdf(-(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) - cdf(-(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.sqrt(duration)*volatility - (Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*price*volatility);
                this.gamma = pdf(-(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) - xpdf(-(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.sqrt(duration)*volatility - (Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*(price*price)*volatility) + (strike*xpdf(Math.sqrt(duration)*volatility - (Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility));
                this.vega = price*pdf(-(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))*(Math.sqrt(duration) - (Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*(volatility*volatility))) + (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.sqrt(duration)*volatility - (Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))*(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate)))/(Math.sqrt(duration)*(volatility*volatility));
            }
            else {                
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double y = Math.log(H*H/(price*strike))/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double x1 = Math.log(price/H)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double y1 = Math.log(H/price)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = -price*cdf(-x1) + strike*Math.exp(-riskFreeRate*duration)*cdf(-x1 + volatility*Math.sqrt(duration)) + price*Math.pow(H/price, 2*g)*(cdf(y) - cdf(y1)) - strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*(cdf(y - volatility*Math.sqrt(duration)) - cdf(y1 - volatility*Math.sqrt(duration)));
                this.delta = pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) - (cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) - cdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + ((pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*volatility) - (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*price*volatility) + (barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*((volatility*volatility) + 2*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(price*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*(pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) - (barrier*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price)*(volatility*volatility));
                this.gamma = pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) - xpdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) + ((pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) - ((xpdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - xpdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*price*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*(price*price)*volatility) + (strike*xpdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*(xpdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - xpdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*(price*price)*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*(pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*volatility) + (2*barrier*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price*price)*(volatility*volatility)) - (2*barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*((volatility*volatility) + 2*riskFreeRate)*(pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*(volatility*volatility*volatility)) - (2*(barrier*barrier)*riskFreeRate*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500)*((volatility*volatility) + 2*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price)*(volatility*volatility*volatility*volatility)) + (2*barrier*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/(Math.sqrt(duration)*(price*price*price)*(volatility*volatility*volatility)) + (2*(barrier*barrier)*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*(- (volatility*volatility) + riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- 3*(volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price*price)*(volatility*volatility*volatility*volatility));
                this.vega = price*((pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(912500*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate - 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) - strike*Math.exp(-duration*riskFreeRate)*((pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(912500*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate + 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) - (price*pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) - (price*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
            }            
        }
        else if (type.equals("PutDownOut")) {
            double H = barrier*Math.exp(-0.5826*volatility*Math.sqrt(1.0/365.0));
            if (H > strike) {
                this.optionPrice = 0;
                this.delta = 0;
                this.gamma = 0;
                this.vega = 0;      
            }
            else {
                double p = strike*Math.exp(-riskFreeRate*duration)*cdf(-d2)-price*cdf(-d1);                
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double y = Math.log(H*H/(price*strike))/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double x1 = Math.log(price/H)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double y1 = Math.log(H/price)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = p - (-price*cdf(-x1) + strike*Math.exp(-riskFreeRate*duration)*cdf(-x1 + volatility*Math.sqrt(duration)) + price*Math.pow(H/price, 2*g)*(cdf(y) - cdf(y1)) - strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*(cdf(y - volatility*Math.sqrt(duration)) - cdf(y1 - volatility*Math.sqrt(duration))));
                this.delta = cdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf(-((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility)) + (cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) - pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) + pdf(-((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) - ((pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*volatility) - (strike*pdf(-(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(Math.sqrt(duration)*price*volatility) + (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*price*volatility) - (barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*((volatility*volatility) + 2*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(price*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*(pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) + (barrier*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price)*(volatility*volatility));
                this.gamma = pdf(-((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) - pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) + xpdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) - xpdf(-((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) - ((pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) + ((xpdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - xpdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*price*(volatility*volatility)) + (strike*pdf(-(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(Math.sqrt(duration)*(price*price)*volatility) + (strike*Math.exp(-duration*riskFreeRate)*xpdf(-(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility)))/(duration*(price*price)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*(price*price)*volatility) - (strike*xpdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*(xpdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - xpdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*(price*price)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*(pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*volatility) - (2*barrier*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price*price)*(volatility*volatility)) + (2*barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*((volatility*volatility) + 2*riskFreeRate)*(pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*(volatility*volatility*volatility)) + (2*(barrier*barrier)*riskFreeRate*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500)*((volatility*volatility) + 2*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price)*(volatility*volatility*volatility*volatility)) - (2*barrier*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/(Math.sqrt(duration)*(price*price*price)*(volatility*volatility*volatility)) - (2*(barrier*barrier)*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*(- (volatility*volatility) + riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- 3*(volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price*price)*(volatility*volatility*volatility*volatility));
                this.vega = strike*Math.exp(-duration*riskFreeRate)*((pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(912500*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate + 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) - price*((pdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (pdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(912500*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate - 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)))*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))) + (price*pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (price*pdf(-((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))*(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate))/(2*Math.sqrt(duration)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/barrier) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) + (strike*pdf(-(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate))/(Math.sqrt(duration)*(volatility*volatility)) + (price*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*(cdf((2*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - cdf((2*Math.log(((barrier*barrier)*Math.exp(-(2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))*(7300000*riskFreeRate*Math.log((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*(volatility*volatility*volatility) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
            }           
        }
        else if (type.equals("PutUpIn")) {
            double H = barrier*Math.exp(0.5826*volatility*Math.sqrt(1.0/365.0));
            if (H < strike) {
                double p = strike*Math.exp(-riskFreeRate*duration)*cdf(-d2)-price*cdf(-d1);
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double x1 = Math.log(price/H)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double y1 = Math.log(H/price)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = p - (-price*cdf(-x1) + strike*Math.exp(-riskFreeRate*duration)*cdf(-x1 + volatility*Math.sqrt(duration)) + price*Math.pow(H/price, 2*g)*cdf(-y1) - strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*cdf(-y1 + volatility*Math.sqrt(duration)));
                this.delta = cdf(- Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5)) - cdf(-(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility)) - cdf(- Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)) - pdf(- Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))/(Math.sqrt(duration)*volatility) + pdf(-(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) - (pdf(- Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)))/(Math.sqrt(duration)*volatility) + (barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*cdf(- Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*((2*riskFreeRate)/(volatility*volatility) + 1)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/price - (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.sqrt(duration)*volatility - (Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*price*volatility) + (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.sqrt(duration)*volatility - Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5)))/(Math.sqrt(duration)*price*volatility) + (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.sqrt(duration)*volatility - Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/(Math.sqrt(duration)*price*volatility) - (barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*Math.exp(-duration*riskFreeRate)*cdf(Math.sqrt(duration)*volatility - Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*((2*riskFreeRate)/(volatility*volatility) - 1)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 2)))/(price*price);
                this.gamma = pdf(-((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) - pdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) + xpdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) - xpdf(-((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) - (pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) - (xpdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*price*(volatility*volatility)) + (strike*pdf(-(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(Math.sqrt(duration)*(price*price)*volatility) + (strike*Math.exp(-duration*riskFreeRate)*xpdf(-(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility)))/(duration*(price*price)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*(price*price)*volatility) - (strike*xpdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility)) + (strike*xpdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*(price*price)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*volatility) - (2*(barrier*barrier)*riskFreeRate*Math.exp((2913*Math.sqrt(365)*volatility)/912500)*cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*((volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price)*(volatility*volatility*volatility*volatility)) + (2*barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price*price)*(volatility*volatility)) + (2*barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*((volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*(volatility*volatility*volatility)) + (2*(barrier*barrier)*strike*Math.exp((2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- 3*(volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price*price)*(volatility*volatility*volatility*volatility)) - (2*barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/(Math.sqrt(duration)*(price*price*price)*(volatility*volatility*volatility));
                this.vega = (price*pdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (price*pdf(-((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))*(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate))/(2*Math.sqrt(duration)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (price*pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(1825000*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (strike*pdf(-(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate))/(Math.sqrt(duration)*(volatility*volatility)) - (barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(2913*Math.sqrt(365)*(volatility*volatility*volatility) - 7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(1825000*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (price*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) - 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
            }
            else {
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double y = Math.log(H*H/(price*strike))/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = -price*Math.pow(H/price, 2*g)*cdf(-y) + strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*cdf(-y + volatility*Math.sqrt(duration));                
                this.delta = (Math.exp(- (2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility)))*(2*(barrier*barrier)*Math.sqrt(duration)*riskFreeRate*Math.exp((8739*Math.sqrt(365)*volatility)/1825000 + duration*riskFreeRate)*cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - (barrier*barrier)*volatility*Math.exp((8739*Math.sqrt(365)*volatility)/1825000 + duration*riskFreeRate)*pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + price*strike*volatility*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + Math.sqrt(duration)*price*strike*(volatility*volatility)*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - 2*Math.sqrt(duration)*price*riskFreeRate*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))))/(barrier*Math.sqrt(duration)*price*(volatility*volatility));
                this.gamma = (Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility)))*(price*strike*(volatility*volatility)*xpdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - (barrier*barrier)*(volatility*volatility)*xpdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp((2913*Math.sqrt(365)*volatility)/912500 + duration*riskFreeRate) + 4*duration*price*(riskFreeRate*riskFreeRate)*strike*cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - 4*(barrier*barrier)*duration*(riskFreeRate*riskFreeRate)*Math.exp((2913*Math.sqrt(365)*volatility)/912500 + duration*riskFreeRate)*cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + Math.sqrt(duration)*price*strike*(volatility*volatility*volatility)*pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + (barrier*barrier)*Math.sqrt(duration)*(volatility*volatility*volatility)*Math.exp((2913*Math.sqrt(365)*volatility)/912500 + duration*riskFreeRate)*pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - 2*duration*price*riskFreeRate*strike*(volatility*volatility)*cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - 2*(barrier*barrier)*duration*riskFreeRate*(volatility*volatility)*Math.exp((2913*Math.sqrt(365)*volatility)/912500 + duration*riskFreeRate)*cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) - 4*Math.sqrt(duration)*price*riskFreeRate*strike*volatility*pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)) + 4*(barrier*barrier)*Math.sqrt(duration)*riskFreeRate*volatility*Math.exp((2913*Math.sqrt(365)*volatility)/912500 + duration*riskFreeRate)*pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))))/(barrier*duration*(price*price)*(volatility*volatility*volatility*volatility));
                this.vega = (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(912500*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) - 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate + 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)) - (price*pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(912500*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) - 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate - 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)) - (barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(2913*Math.sqrt(365)*(volatility*volatility*volatility) - 7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) - (price*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) - 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
            }
        }
        else if (type.equals("PutUpOut")) {
            double H = barrier*Math.exp(0.5826*volatility*Math.sqrt(1.0/365.0));
            if (H < strike) {                
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double x1 = Math.log(price/H)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                double y1 = Math.log(H/price)/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = -price*cdf(-x1) + strike*Math.exp(-riskFreeRate*duration)*cdf(-x1 + volatility*Math.sqrt(duration)) + price*Math.pow(H/price, 2*g)*cdf(-y1) - strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*cdf(-y1 + volatility*Math.sqrt(duration));
                this.delta = cdf(- Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)) - cdf(- Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5)) + pdf(- Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))/(Math.sqrt(duration)*volatility) + (pdf(- Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)))/(Math.sqrt(duration)*volatility) - (barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*cdf(- Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*((2*riskFreeRate)/(volatility*volatility) + 1)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/price - (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.sqrt(duration)*volatility - Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5)))/(Math.sqrt(duration)*price*volatility) - (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.sqrt(duration)*volatility - Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/(Math.sqrt(duration)*price*volatility) + (barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*Math.exp(-duration*riskFreeRate)*cdf(Math.sqrt(duration)*volatility - Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price)/(Math.sqrt(duration)*volatility) - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5))*((2*riskFreeRate)/(volatility*volatility) - 1)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 2)))/(price*price);
                this.gamma = pdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) - xpdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) + (pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*price*volatility) + (xpdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*price*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*(price*price)*volatility) + (strike*xpdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility)) - (strike*xpdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(duration*(price*price)*(volatility*volatility)) + (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*volatility) + (2*(barrier*barrier)*riskFreeRate*Math.exp((2913*Math.sqrt(365)*volatility)/912500)*cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*((volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price)*(volatility*volatility*volatility*volatility)) - (2*barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/((price*price*price)*(volatility*volatility)) - (2*barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*((volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*(volatility*volatility*volatility)) - (2*(barrier*barrier)*strike*Math.exp((2913*Math.sqrt(365)*volatility)/912500 - duration*riskFreeRate)*cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + riskFreeRate)*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- 3*(volatility*volatility) + 2*riskFreeRate)/(volatility*volatility))))/((price*price*price*price)*(volatility*volatility*volatility*volatility)) + (2*barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(- (volatility*volatility) + 2*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*(- (volatility*volatility) + riskFreeRate))/(volatility*volatility))))/(Math.sqrt(duration)*(price*price*price)*(volatility*volatility*volatility));
                this.vega = (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) - (price*pdf(-(2*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(1825000*Math.log((price*Math.exp(-(2913*Math.sqrt(365)*volatility)/1825000))/barrier) + 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (price*pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(1825000*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate - 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(2913*Math.sqrt(365)*(volatility*volatility*volatility) - 7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(1825000*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) - 2913*Math.sqrt(365)*volatility + 1825000*duration*riskFreeRate + 912500*duration*(volatility*volatility)))/(1825000*Math.sqrt(duration)*(volatility*volatility)) + (price*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf(-(2*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) - 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
            }
            else {
                double p = strike*Math.exp(-riskFreeRate*duration)*cdf(-d2)-price*cdf(-d1);
                double g = riskFreeRate/(volatility*volatility) + 0.5;
                double y = Math.log(H*H/(price*strike))/(volatility*Math.sqrt(duration)) + g*volatility*Math.sqrt(duration);
                this.optionPrice = p - (-price*Math.pow(H/price, 2*g)*cdf(-y) + strike*Math.exp(-riskFreeRate*duration)*Math.pow(H/price, 2*g - 2)*cdf(-y + volatility*Math.sqrt(duration)));                
                this.delta = cdf(- Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)) - cdf(-(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility)) + pdf(-(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*volatility) + (pdf(- Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)))/(Math.sqrt(duration)*volatility) - (barrier*cdf(- Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*((2*riskFreeRate)/(volatility*volatility) + 1)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/price - (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.sqrt(duration)*volatility - (Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*price*volatility) - (strike*pdf(Math.sqrt(duration)*volatility - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/(Math.sqrt(duration)*price*volatility) + (barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*Math.exp(-duration*riskFreeRate)*cdf(Math.sqrt(duration)*volatility - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*((2*riskFreeRate)/(volatility*volatility) - 1)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 2)))/(price*price);
                this.gamma = pdf(-(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(Math.sqrt(duration)*price*volatility) - xpdf(-(Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))/(duration*price*(volatility*volatility)) + (xpdf(- Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)))/(duration*price*(volatility*volatility)) + (pdf(- Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) + 1)))/(Math.sqrt(duration)*price*volatility) + (strike*Math.exp(-duration*riskFreeRate)*pdf(Math.sqrt(duration)*volatility - (Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility)))/(Math.sqrt(duration)*(price*price)*volatility) + (strike*xpdf(Math.sqrt(duration)*volatility - (Math.log(price/strike) + duration*((volatility*volatility)/2 + riskFreeRate))/(Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate))/(duration*(price*price)*(volatility*volatility)) + (strike*pdf(Math.sqrt(duration)*volatility - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/(Math.sqrt(duration)*(price*price)*volatility) - (strike*xpdf(Math.sqrt(duration)*volatility - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/(duration*(price*price)*(volatility*volatility)) - (2*barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*pdf(- Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*((2*riskFreeRate)/(volatility*volatility) + 1)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(Math.sqrt(duration)*(price*price)*volatility) + (2*(barrier*barrier)*riskFreeRate*cdf(- Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp((2913*Math.sqrt(365)*volatility)/912500)*((2*riskFreeRate)/(volatility*volatility) + 1)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 1)))/((price*price*price)*(volatility*volatility)) - (2*barrier*strike*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*Math.exp(-duration*riskFreeRate)*cdf(Math.sqrt(duration)*volatility - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*((2*riskFreeRate)/(volatility*volatility) - 1)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 2)))/(price*price*price) - ((barrier*barrier)*strike*Math.exp((2913*Math.sqrt(365)*volatility)/912500)*Math.exp(-duration*riskFreeRate)*cdf(Math.sqrt(duration)*volatility - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*((2*riskFreeRate)/(volatility*volatility) - 1)*((2*riskFreeRate)/(volatility*volatility) - 2)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 3)))/(price*price*price*price) + (2*barrier*strike*pdf(Math.sqrt(duration)*volatility - Math.sqrt(duration)*volatility*(riskFreeRate/(volatility*volatility) + 0.5) - Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike))/(Math.sqrt(duration)*volatility))*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*Math.exp(-duration*riskFreeRate)*((2*riskFreeRate)/(volatility*volatility) - 1)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility) - 2)))/(Math.sqrt(duration)*(price*price*price)*volatility);
                this.vega = (barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000)*cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(2913*Math.sqrt(365)*(volatility*volatility*volatility) - 7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*(volatility*volatility*volatility)) - (price*pdf(-((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate)/(Math.sqrt(duration)*volatility))*(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate))/(2*Math.sqrt(duration)*(volatility*volatility)) + (strike*pdf(-(- duration*(volatility*volatility) + 2*Math.log(price/strike) + 2*duration*riskFreeRate)/(2*Math.sqrt(duration)*volatility))*Math.exp(-duration*riskFreeRate)*((duration*(volatility*volatility))/2 + Math.log(price/strike) + duration*riskFreeRate))/(Math.sqrt(duration)*(volatility*volatility)) + (price*pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate + duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),(((volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(912500*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) - 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate - 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)) - (strike*Math.exp(-duration*riskFreeRate)*pdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((- (volatility*volatility) + 2*riskFreeRate)/(volatility*volatility)))*(912500*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) - 2913*Math.sqrt(365)*volatility + 912500*duration*riskFreeRate + 456250*duration*(volatility*volatility)))/(912500*Math.sqrt(duration)*(volatility*volatility)) + (price*strike*Math.exp(- (2913*Math.sqrt(365)*volatility)/1825000 - duration*riskFreeRate)*cdf(-(2*Math.log(((barrier*barrier)*Math.exp((2913*Math.sqrt(365)*volatility)/912500))/(price*strike)) + 2*duration*riskFreeRate - duration*(volatility*volatility))/(2*Math.sqrt(duration)*volatility))*(7300000*riskFreeRate*Math.log((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price) + 2913*Math.sqrt(365)*(volatility*volatility*volatility) - 5826*Math.sqrt(365)*riskFreeRate*volatility)*Math.pow(((barrier*Math.exp((2913*Math.sqrt(365)*volatility)/1825000))/price),((2*riskFreeRate)/(volatility*volatility))))/(1825000*barrier*(volatility*volatility*volatility));
             }
        }        
    }

    public double GetPrice() {
        return this.optionPrice;
    }

    public double GetDelta() {
        return this.delta;
    }

    public double GetGamma() {
        return this.gamma;
    }

    public double GetVega() {
        return this.vega;
    }
    
    private double cdf(double x) {
        double sqrtpi = 1.7724538509055160272981674833411;
        double sqrt2 = 1.4142135623730950488016887242097;
        double sum = 0.0;
        int n = 0;
        double z = x/sqrt2;
        double a = z;
        double erf;
        double aa = 10;

        while (aa > 1e-20) {
            sum += a;
            n++;
            a *= -z*z/(n*(2*n+1.0)/(2*n-1.0));
            aa = (a < 0) ? -a : a;            
        }
        sum += a;
        erf = sum/sqrtpi;

        return (0.5 + erf);
    }

    private double pdf(double x) {
        return Math.exp(-x*x/2)/2.506628274631000502415765284811;
    }

    private double xpdf(double x) {
        return -x*Math.exp(-x*x/2)/2.506628274631000502415765284811;
    }
    
}
